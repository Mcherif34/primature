<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Inscriptions Externes - Primature</title>
    
    <!-- Bootstrap CSS -->
    <link href="/primature/resources/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/primature/resources/assets/css/app.min.css" rel="stylesheet" type="text/css" />
    <link href="/primature/resources/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    
    <!-- Font Awesome -->
    <link href="/primature/resources/assets/libs/font-awesome/css/all.min.css" rel="stylesheet" type="text/css" />
    
    <!-- DataTables CSS -->
    <link href="/primature/resources/assets/libs/datatables.net-bs5/css/dataTables.bootstrap5.min.css" rel="stylesheet" type="text/css" />
    <link href="/primature/resources/assets/libs/datatables.net-responsive-bs5/css/responsive.bootstrap5.min.css" rel="stylesheet" type="text/css" />
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #097bc1;
            --secondary-color: #3577f1;
            --success-color: #00BA59;
            --info-color: #299cdb;
            --warning-color: #ffbe0b;
            --danger-color: #f06548;
            --light-color: #f3f6f9;
            --dark-color: #212529;
            --border-color: #e9ebec;
            --text-muted: #878a99;
        }
        
        body {
            background: var(--light-color);
            font-family: 'Inter', sans-serif;
        }
        
        .page-content {
            padding: 2rem;
        }
        
        .page-title {
            color: var(--dark-color);
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .page-title i {
            color: var(--primary-color);
            font-size: 2rem;
        }
        
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            padding: 1.5rem 2rem;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .card-body {
            padding: 2rem;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card.pending {
            border-left-color: var(--warning-color);
        }
        
        .stat-card.approved {
            border-left-color: var(--success-color);
        }
        
        .stat-card.rejected {
            border-left-color: var(--danger-color);
        }
        
        .stat-card.total {
            border-left-color: var(--info-color);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        .stat-icon {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 2rem;
            opacity: 0.1;
        }
        
        .btn {
            border-radius: 8px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(9, 123, 193, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color) 0%, #28a745 100%);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 186, 89, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #dc3545 100%);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(240, 101, 72, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color) 0%, #fd7e14 100%);
            color: white;
        }
        
        .btn-warning:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(255, 190, 11, 0.3);
        }
        
        .btn-sm {
            padding: 0.25rem 0.75rem;
            font-size: 0.8rem;
        }
        
        .table {
            border-radius: 8px;
            overflow: hidden;
        }
        
        .table thead th {
            background: var(--light-color);
            border: none;
            font-weight: 600;
            color: var(--dark-color);
            padding: 1rem;
            font-size: 0.9rem;
        }
        
        .table tbody td {
            padding: 1rem;
            border: none;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }
        
        .table tbody tr:hover {
            background: rgba(9, 123, 193, 0.02);
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending {
            background: rgba(255, 190, 11, 0.1);
            color: var(--warning-color);
        }
        
        .status-approved {
            background: rgba(0, 186, 89, 0.1);
            color: var(--success-color);
        }
        
        .status-rejected {
            background: rgba(240, 101, 72, 0.1);
            color: var(--danger-color);
        }
        
        .modal-content {
            border: none;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            border-radius: 16px 16px 0 0;
            padding: 1.5rem 2rem;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .modal-footer {
            border: none;
            padding: 1.5rem 2rem;
            background: var(--light-color);
            border-radius: 0 0 16px 16px;
        }
        
        .form-control {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(9, 123, 193, 0.15);
        }
        
        .alert {
            border-radius: 8px;
            border: none;
            padding: 1rem 1.5rem;
        }
        
        .alert-success {
            background: rgba(0, 186, 89, 0.1);
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }
        
        .alert-danger {
            background: rgba(240, 101, 72, 0.1);
            color: var(--danger-color);
            border-left: 4px solid var(--danger-color);
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .spinner-border {
            width: 2rem;
            height: 2rem;
            color: var(--primary-color);
        }
        
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter {
            margin-bottom: 1rem;
        }
        
        .dataTables_wrapper .dataTables_info,
        .dataTables_wrapper .dataTables_paginate {
            margin-top: 1rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            border-radius: 6px;
            border: 1px solid var(--border-color);
            margin: 0 0.25rem;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white !important;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background: var(--light-color);
            border-color: var(--primary-color);
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-muted);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }
        
        .empty-state h4 {
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }
        
        @media (max-width: 768px) {
            .page-content {
                padding: 1rem;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            .table-responsive {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="page-content">
        <!-- Page Title -->
        <div class="page-title">
            <i class="fas fa-users"></i>
            <div>
                <h1 class="mb-0">Gestion des Inscriptions Externes</h1>
                <small class="text-muted">Administration des demandes d'inscription des partenaires externes</small>
            </div>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-cards">
            <div class="stat-card total">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">Total des Demandes</div>
            </div>
            <div class="stat-card pending">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-number" id="pendingCount">0</div>
                <div class="stat-label">En Attente</div>
            </div>
            <div class="stat-card approved">
                <div class="stat-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-number" id="approvedCount">0</div>
                <div class="stat-label">Approuvées</div>
            </div>
            <div class="stat-card rejected">
                <div class="stat-icon">
                    <i class="fas fa-times-circle"></i>
                </div>
                <div class="stat-number" id="rejectedCount">0</div>
                <div class="stat-label">Rejetées</div>
            </div>
        </div>
        
        <!-- Main Card -->
        <div class="card">
            <div class="card-header">
                <i class="fas fa-list me-2"></i>
                Liste des Demandes d'Inscription
            </div>
            <div class="card-body">
                <!-- Alerts -->
                <div id="alertContainer"></div>
                
                <!-- Loading Spinner -->
                <div class="loading-spinner" id="loadingSpinner">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Chargement...</span>
                    </div>
                    <p class="mt-3">Chargement des données...</p>
                </div>
                
                <!-- DataTable -->
                <div id="tableContainer">
                    <table id="registrationsTable" class="table table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nom Complet</th>
                                <th>Email</th>
                                <th>Institution</th>
                                <th>Fonction</th>
                                <th>Date de Demande</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data will be loaded dynamically -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Empty State -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <h4>Aucune demande d'inscription</h4>
                    <p>Aucune demande d'inscription externe n'a été soumise pour le moment.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Details Modal -->
    <div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detailsModalLabel">
                        <i class="fas fa-user me-2"></i>Détails de la Demande
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="registrationDetails">
                        <!-- Details will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Fermer
                    </button>
                    <button type="button" class="btn btn-success" id="approveBtn" style="display: none;">
                        <i class="fas fa-check me-2"></i>Approuver
                    </button>
                    <button type="button" class="btn btn-danger" id="rejectBtn" style="display: none;">
                        <i class="fas fa-times me-2"></i>Rejeter
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Rejection Modal -->
    <div class="modal fade" id="rejectionModal" tabindex="-1" aria-labelledby="rejectionModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="rejectionModalLabel">
                        <i class="fas fa-times-circle me-2"></i>Motif du Rejet
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="rejectionForm">
                        <div class="mb-3">
                            <label for="rejectionReason" class="form-label">Motif du rejet *</label>
                            <textarea class="form-control" id="rejectionReason" rows="4" 
                                      placeholder="Veuillez expliquer le motif du rejet de cette demande..." required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Annuler
                    </button>
                    <button type="button" class="btn btn-danger" id="confirmRejectionBtn">
                        <i class="fas fa-times me-2"></i>Confirmer le Rejet
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="/primature/resources/assets/libs/jquery/jquery.min.js"></script>
    <script src="/primature/resources/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/primature/resources/assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="/primature/resources/assets/libs/datatables.net-bs5/js/dataTables.bootstrap5.min.js"></script>
    <script src="/primature/resources/assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="/primature/resources/assets/libs/datatables.net-responsive-bs5/js/responsive.bootstrap5.min.js"></script>
    
    <script>
        // Variables globales
        var currentRegistrationId = null;
        var dataTable = null;
        
        // Initialisation
        $(document).ready(function() {
            loadRegistrations();
            initializeEventListeners();
        });
        
        // Chargement des inscriptions
        function loadRegistrations() {
            showLoading(true);
            
            $.ajax({
                url: '/primature/api/external-registration/list',
                method: 'GET',
                success: function(response) {
                    if (response.success) {
                        updateStatistics(response.data);
                        populateTable(response.data);
                    } else {
                        showAlert('Erreur lors du chargement des données: ' + response.message, 'danger');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Erreur AJAX:', error);
                    showAlert('Erreur lors du chargement des données. Veuillez réessayer.', 'danger');
                },
                complete: function() {
                    showLoading(false);
                }
            });
        }
        
        // Mise à jour des statistiques
        function updateStatistics(data) {
            var total = data.length;
            var pending = data.filter(item => item.statut === 'EN_ATTENTE').length;
            var approved = data.filter(item => item.statut === 'APPROUVEE').length;
            var rejected = data.filter(item => item.statut === 'REJETEE').length;
            
            $('#totalCount').text(total);
            $('#pendingCount').text(pending);
            $('#approvedCount').text(approved);
            $('#rejectedCount').text(rejected);
        }
        
        // Peuplement du tableau
        function populateTable(data) {
            if (dataTable) {
                dataTable.destroy();
            }
            
            var tbody = $('#registrationsTable tbody');
            tbody.empty();
            
            if (data.length === 0) {
                $('#tableContainer').hide();
                $('#emptyState').show();
                return;
            }
            
            $('#emptyState').hide();
            $('#tableContainer').show();
            
            data.forEach(function(item) {
                var row = createTableRow(item);
                tbody.append(row);
            });
            
            // Initialisation de DataTable
            dataTable = $('#registrationsTable').DataTable({
                responsive: true,
                language: {
                    url: '/primature/resources/assets/libs/datatables.net/js/dataTables.french.json'
                },
                order: [[5, 'desc']], // Trier par date de demande décroissante
                pageLength: 25,
                columnDefs: [
                    { orderable: false, targets: 7 } // Actions column
                ]
            });
        }
        
        // Création d'une ligne de tableau
        function createTableRow(item) {
            var statusClass = getStatusClass(item.statut);
            var statusText = getStatusText(item.statut);
            var date = new Date(item.dateDemande).toLocaleDateString('fr-FR');
            
            var actions = '';
            if (item.statut === 'EN_ATTENTE') {
                actions = `
                    <button class="btn btn-sm btn-primary me-1" onclick="viewDetails(${item.id})" title="Voir les détails">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-success me-1" onclick="approveRegistration(${item.id})" title="Approuver">
                        <i class="fas fa-check"></i>
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="rejectRegistration(${item.id})" title="Rejeter">
                        <i class="fas fa-times"></i>
                    </button>
                `;
            } else {
                actions = `
                    <button class="btn btn-sm btn-primary" onclick="viewDetails(${item.id})" title="Voir les détails">
                        <i class="fas fa-eye"></i>
                    </button>
                `;
            }
            
            return `
                <tr>
                    <td>${item.id}</td>
                    <td><strong>${item.prenom} ${item.nom}</strong></td>
                    <td>${item.email}</td>
                    <td>${item.institution}</td>
                    <td>${item.fonction}</td>
                    <td>${date}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>${actions}</td>
                </tr>
            `;
        }
        
        // Classes CSS pour les statuts
        function getStatusClass(statut) {
            switch (statut) {
                case 'EN_ATTENTE': return 'status-pending';
                case 'APPROUVEE': return 'status-approved';
                case 'REJETEE': return 'status-rejected';
                default: return 'status-pending';
            }
        }
        
        // Texte des statuts
        function getStatusText(statut) {
            switch (statut) {
                case 'EN_ATTENTE': return 'En Attente';
                case 'APPROUVEE': return 'Approuvée';
                case 'REJETEE': return 'Rejetée';
                default: return 'Inconnu';
            }
        }
        
        // Affichage des détails
        function viewDetails(id) {
            currentRegistrationId = id;
            
            $.ajax({
                url: '/primature/api/external-registration/' + id,
                method: 'GET',
                success: function(response) {
                    if (response.success) {
                        showDetailsModal(response.data);
                    } else {
                        showAlert('Erreur lors du chargement des détails: ' + response.message, 'danger');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Erreur AJAX:', error);
                    showAlert('Erreur lors du chargement des détails.', 'danger');
                }
            });
        }
        
        // Affichage du modal de détails
        function showDetailsModal(data) {
            var dateDemande = new Date(data.dateDemande).toLocaleDateString('fr-FR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            var detailsHtml = `
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-primary mb-3"><i class="fas fa-user me-2"></i>Informations Personnelles</h6>
                        <p><strong>Prénom :</strong> ${data.prenom}</p>
                        <p><strong>Nom :</strong> ${data.nom}</p>
                        <p><strong>Email :</strong> ${data.email}</p>
                        <p><strong>Téléphone :</strong> ${data.telephone || 'Non renseigné'}</p>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-primary mb-3"><i class="fas fa-building me-2"></i>Informations Professionnelles</h6>
                        <p><strong>Institution :</strong> ${data.institution}</p>
                        <p><strong>Fonction :</strong> ${data.fonction}</p>
                        <p><strong>Ville :</strong> ${data.ville || 'Non renseignée'}</p>
                        <p><strong>Adresse :</strong> ${data.adresse || 'Non renseignée'}</p>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-12">
                        <h6 class="text-primary mb-3"><i class="fas fa-info-circle me-2"></i>Informations de la Demande</h6>
                        <p><strong>Date de demande :</strong> ${dateDemande}</p>
                        <p><strong>Statut :</strong> <span class="status-badge ${getStatusClass(data.statut)}">${getStatusText(data.statut)}</span></p>
                        ${data.motifRejet ? `<p><strong>Motif du rejet :</strong> ${data.motifRejet}</p>` : ''}
                    </div>
                </div>
            `;
            
            $('#registrationDetails').html(detailsHtml);
            
            // Afficher/masquer les boutons selon le statut
            if (data.statut === 'EN_ATTENTE') {
                $('#approveBtn, #rejectBtn').show();
            } else {
                $('#approveBtn, #rejectBtn').hide();
            }
            
            $('#detailsModal').modal('show');
        }
        
        // Approbation d'une inscription
        function approveRegistration(id) {
            if (confirm('Êtes-vous sûr de vouloir approuver cette demande d\'inscription ?')) {
                $.ajax({
                    url: '/primature/api/external-registration/' + id + '/approve',
                    method: 'POST',
                    success: function(response) {
                        if (response.success) {
                            showAlert('Demande approuvée avec succès ! Un email a été envoyé au demandeur.', 'success');
                            $('#detailsModal').modal('hide');
                            loadRegistrations();
                        } else {
                            showAlert('Erreur lors de l\'approbation: ' + response.message, 'danger');
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error('Erreur AJAX:', error);
                        showAlert('Erreur lors de l\'approbation.', 'danger');
                    }
                });
            }
        }
        
        // Rejet d'une inscription
        function rejectRegistration(id) {
            currentRegistrationId = id;
            $('#rejectionReason').val('');
            $('#rejectionModal').modal('show');
        }
        
        // Confirmation du rejet
        function confirmRejection() {
            var reason = $('#rejectionReason').val().trim();
            
            if (!reason) {
                showAlert('Veuillez saisir un motif de rejet.', 'danger');
                return;
            }
            
            $.ajax({
                url: '/primature/api/external-registration/' + currentRegistrationId + '/reject',
                method: 'POST',
                data: JSON.stringify({ motifRejet: reason }),
                contentType: 'application/json',
                success: function(response) {
                    if (response.success) {
                        showAlert('Demande rejetée avec succès ! Un email a été envoyé au demandeur.', 'success');
                        $('#rejectionModal').modal('hide');
                        $('#detailsModal').modal('hide');
                        loadRegistrations();
                    } else {
                        showAlert('Erreur lors du rejet: ' + response.message, 'danger');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Erreur AJAX:', error);
                    showAlert('Erreur lors du rejet.', 'danger');
                }
            });
        }
        
        // Affichage des alertes
        function showAlert(message, type) {
            var alertClass = type === 'danger' ? 'alert-danger' : 'alert-success';
            var iconClass = type === 'danger' ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';
            
            var alertHtml = `
                <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
                    <i class="${iconClass} me-2"></i>
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            
            $('#alertContainer').html(alertHtml);
            
            // Auto-dismiss après 5 secondes
            setTimeout(function() {
                $('#alertContainer .alert').fadeOut();
            }, 5000);
        }
        
        // Affichage du spinner de chargement
        function showLoading(show) {
            if (show) {
                $('#loadingSpinner').show();
                $('#tableContainer').hide();
            } else {
                $('#loadingSpinner').hide();
                $('#tableContainer').show();
            }
        }
        
        // Initialisation des événements
        function initializeEventListeners() {
            // Bouton d'approbation dans le modal
            $('#approveBtn').click(function() {
                approveRegistration(currentRegistrationId);
            });
            
            // Bouton de rejet dans le modal
            $('#rejectBtn').click(function() {
                rejectRegistration(currentRegistrationId);
            });
            
            // Confirmation du rejet
            $('#confirmRejectionBtn').click(function() {
                confirmRejection();
            });
            
            // Fermeture des modals
            $('.modal').on('hidden.bs.modal', function() {
                currentRegistrationId = null;
            });
        }
    </script>
</body>
</html> 